<!DOCTYPE html>
<html>
<head>
	<title>Hello</title>
</head>
<body>
	<form enctype="multipart/form-data" id="form">
		<input type="file" name="file" autocomplete="false">
		<input type="submit" value='submit'>
	</form>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
	<script>
		
		'use strict'

		var permlink = (links) =>{
			$('#permlink').remove();
			for(var i = 0; i < links.length; i++)
				$('body').append("<div id='permlink'>"+
								 	"<label>Permanent Link:-</label>"+
								 	'<h3><a href="http://localhost:3000/file/'+links[i]+'">http://localhost:3000/file/'+links[i]+'</a></h3>'+
								 "</div>"
				)
			
		}

		var postreq = (url) =>{
			var fd = new FormData($('form')[0]);
			$.ajax({
				method: 'post',
				url: url,
				data: fd,
				cache: false,
				contentType: false,
				processData: false,
				success: (data)=>{
					permlink(data);
				}
			});
		}

		$('#form').on('submit', (e)=>{
			var filetype = $('input[name="file"]').val().split('.').pop();

			e.preventDefault();
			if (filetype === "zip"){
				postreq('/file/zip');				
			} else if (filetype.match(/jpg|jpeg|png/)){
				postreq('/file/image');
			} else{
				permlink("Error: please upload images in jpg or jpeg or png or zip format only");
			}
			$('input[name="file"]').val("");
		});
	</script>
</body>
</html>